#Import packages
library(qs)
library(devtools)
#load the poweranalysis package
load_all("/Users/caominjie/Desktop/PowerAnalysis/Power_Analysis_package") #simulate library() without installing the package
library(poweranalysis)
help(package = "poweranalysis")
browseVignettes(package = "poweranalysis")
library(qs)
library(devtools)
setwd("~/Desktop/PowerAnalysis/Power_Analysis_package")
#load the poweranalysis package
load_all("~/Desktop/PowerAnalysis/Power_Analysis_package")
library(poweranalysis)
### Test: Bulk Analysis
allen_path <- system.file("extdata", "Allen_Endo_subset.qs", package="poweranalysis")
allen_endo <- qs::qread(allen_path)
tsai_path <- system.file("extdata", "Tsai_Micro.qs", package="poweranalysis")
tsai_micro <- qs::qread(tsai_path)
zhou_path <- system.file("extdata", "Zhou_Astro_subset.qs", package="poweranalysis")
zhou_astro <- qs::qread(zhou_path)
bulk_path <- system.file("extdata", "LFSR.tsv", package="poweranalysis")
bulkDE <- read.table(bulk_path, sep = '\t', header = TRUE)
SCEs <- list(allen_endo, tsai_micro, zhou_astro)
dataset_names <- c("Allen_Endo", "Tsai_Micro","Zhou_Astro")
celltype_corr <- list(Endo=c("cerebral cortex endothelial cell",NA,NA),
Micro=c(NA,"Micro",NA),
Astro=c(NA,NA,"Astro"))
celltypeIDs <- c("cell_type","cluster_celltype","cluster_celltype")
sampleIDs <- c("donor_id","sample_id","sample_id")
output_path = path.expand("~/Desktop/PowerAnalysis/test_bulk")
poweranalysis::bulk_power_analysis(
SCEs,
dataset_names,
celltype_corr,
celltypeIDs=celltypeIDs,
sampleIDs=sampleIDs,
bulkDE=bulkDE,
output_path=output_path,
Nperms=3)
?bulk_power_analysis
typeof(bulkDE)
#Rebuild the package and check:
devtools::document()
setwd("~/Desktop/PowerAnalysis/Power_Analysis_package")
#Rebuild the package and check:
devtools::document()
#Rebuild the package and check:
devtools::document()
